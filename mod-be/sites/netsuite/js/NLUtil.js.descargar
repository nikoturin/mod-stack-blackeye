function checkForModuleDependency(){return require.defined("N/format")&&require.defined("N/validator");}if(!Array.prototype.push){Array.prototype.push=function(){var b=this.length;for(var a=0;a<arguments.length;a++){this[b+a]=arguments[a];}return this.length;};}try{parentAccesible=(typeof parent.encode!="undefined");}catch(e){parentAccesible=false;}var isNS=(!isBackend&&document.addEventListener)?true:false;function encode(a){return encodeURIComponent(a);}function alphafirst(b){var a=new RegExp("([A-Za-z].*)");return(a.exec(b)!=null&&RegExp.$1==b);}function stacktrace(){var d="stacktrace: ";var f=[];var c=arguments.callee.caller;while(c!==null){var g=getFuncName(c);var b=getFuncArgs(c);var a=c.caller;var j=f.indexOf(g)!==-1;var h=f.length>50;var i=(a===c);if(j||h||i){break;}d+=g+b+"\n\n";f.push(g);c=a;}return d;}function getFuncArgs(b){var d="arguments: {";for(var c=0;c<b.arguments.length;c++){if(typeof b.arguments[c]=="undefined"){d+="'undefined'";}else{if(b.arguments[c]==null){d+="null";}else{if(typeof b.arguments[c]=="string"){d+="'"+b.arguments[c].toString()+"'";}else{d+=b.arguments[c].toString();}}}if(c<b.arguments.length-1){d+=",";}}d+="}";return d;}function getFuncName(b){var a=b.toString();if(a.indexOf("anonymous")>=0){if(a.length>100){return a.substr(0,100)+"\n";}else{return a+"\n";}}else{a=a.match(/function[^{]*/);if(a!==null){a=a[0];}}if((a==null)||(a.length==0)){return"anonymous \n";}return a;}function scrollDiv(){if(document.getElementById("div__label")){document.getElementById("div__label").scrollLeft=document.getElementById("div__body").scrollLeft;}}function getVisibleWindowHeight(){var a=(window.parentAccesible&&parent&&parent.NS&&parent.NS.Window.getActive());return(a?parent.NS.Window.getActive().content.contentWindow.innerHeight:jQuery(window).height());}function getDocumentHeight(){if(window.innerHeight){return window.innerHeight;}else{if(document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientHeight!=0){return document.documentElement.clientHeight;}else{return document.body.clientHeight;}}}function getDocumentWidth(){if(window.innerWidth){return window.innerWidth;}else{if(document.documentElement&&document.documentElement.clientWidth&&document.documentElement.clientWidth!=0){return document.documentElement.clientWidth;}else{return document.body.clientWidth;}}}function getWindowPageXOffset(){return(window.pageXOffset!==undefined)?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft;}function getWindowPageYOffset(){return(window.pageYOffset!==undefined)?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;}function getElementContentWidth(a){return a.offsetWidth-getRuntimeSize(a,"paddingLeft")-getRuntimeSize(a,"paddingRight")-getRuntimeSize(a,"borderLeftWidth")-getRuntimeSize(a,"borderRightWidth")-getRuntimeSize(a,"marginLeft")-getRuntimeSize(a,"marginRight");}function getElementContentHeight(a){return a.offsetHeight-getRuntimeSize(a,"paddingTop")-getRuntimeSize(a,"paddingBottom")-getRuntimeSize(a,"borderTopWidth")-getRuntimeSize(a,"borderBottomWidth")-getRuntimeSize(a,"marginTop")-getRuntimeSize(a,"marginBottom");}var ieDiffWidth=0;var ieDiffHeight=0;function initOuter(){var a,f,b,g,d,i;var j=800;var c=600;if(document.all){b=document.body.offsetWidth;g=document.body.offsetHeight;window.resizeTo(j,c);d=document.body.offsetWidth-b;i=document.body.offsetHeight-g;a=j-d;f=c-i;ieDiffWidth=a-b;ieDiffHeight=f-g;window.resizeTo(a,f);}}function outerWd(){if(document.all){if(ieDiffHeight==0){initOuter();}return document.body.offsetWidth+ieDiffWidth;}else{return window.outerWidth;}}function outerHt(){if(document.all){if(ieDiffHeight==0){initOuter();}return document.body.offsetHeight+ieDiffHeight;}else{return window.outerHeight;}}function onBeforePrint(){var a=document.getElementById("div__label");if(a!=null){a.style.width=null;a.style.height=null;}a=document.getElementById("div__body");if(a!=null){a.style.width=null;a.style.height=null;}document.body.scroll="auto";}function onAfterPrint(){if(document.getElementById("resetdivwascalled")!=null){resetDivSizes();}}if(!isBackend){window.onbeforeprint=onBeforePrint;window.onafterprint=onAfterPrint;}function getNavTreePaneDivID(){return"div__nav_tree";}function hideInvisibleRows(){var d=document.getElementById("squeezeBox");if(d==null){return;}var a=d.getElementsByTagName("tr");var c=0;for(var b=0;b<a.length;b++){if(a[b].className=="labelRow"&&isValEmpty(a[b].getAttribute("squeezeBox"))){c+=a[b].offsetHeight+1;a[b].setAttribute("squeezeBox","T");}}if(c>0){d.style.overflow="hidden";d.style.height=d.offsetHeight-c+(isIE?0:28)+"px";}}function resizePopupWindow(){var c=document.getElementById("div__body");if(c==null){return;}var f=getDocumentWidth()-10;var d=getMaxContentWidth(c.getElementsByTagName("span"));var b=getMaxContentWidth(c.getElementsByTagName("div"));var a=Math.max(c.scrollWidth,Math.max(d,b));if(a>f){window.resizeBy(a-f,0);}}function getMaxContentWidth(a){var c=0;for(var b=0;b<a.length;b++){if(a[b].scrollWidth>c){c=a[b].scrollWidth;}}return c;}function getHeight(a){if(a==null){return 0;}else{return a.offsetHeight?a.offsetHeight:0;}}function makeVisible(a){if(a!=null){a.style.visibility="visible";}}function visible(b,a){if(b!=null){b.style.visibility=a?"inherit":"hidden";}}function endsWith(b,a){return b!=null&&a!=null&&b.length>=a.length&&b.substr(b.length-a.length)==a;}function splitIntoRows(a){return a!=null?(a.length>0?a.split(String.fromCharCode(2)):[]):null;}function splitIntoCells(a){return a!=null?(typeof(a)=="string"?a.split(String.fromCharCode(1)):a):null;}function isempty(a,b){var c=a.value;return isValEmpty(c,b);}function parseCJKNumbers(f){var g=f.value;if(g==null){return null;}var c=/[\uff01-\uff5e]/g;var b=[];var a,d=0;c.lastIndex=0;while((a=c.exec(g))!=null){if(a.index>d){b.push(g.substring(d,a.index));}d=c.lastIndex;b.push(String.fromCharCode(a[0].charCodeAt(0)-65248));}if(d==0){return g;}if(d<g.length){b.push(g.substring(d));}return b.join("");}function getIndexForSelection(f,a){var d=f.replace(/\r/g,"");var c=0;for(var b=0;b<d.length;++b){var g=d.charCodeAt(b);if(g==10){c++;}c++;if(c>a){return b;}}return 0;}function truncateStringInUnicode(g,c){var j=0;var d=128;var b=2048;var f="";for(var a=0;a<g.length;a++){var h=g.charCodeAt(a);if(h<d){j+=1;}else{if(h>=d&&h<b){j+=2;}else{if(h>=b){j+=3;}}}if(j<c){f=f+g.charAt(a);}}return f;}function UTF8toUTF16index(g,b){g=g.replace(/\r/g,"");var a=0;var f=128;var d=2048;for(var c=0;c<g.length;++c){var h=g.charCodeAt(c);if(h==10){a+=2;}else{if(h<f){a+=1;}else{if(h<d){a+=2;}else{a+=3;}}}if(a>b){return c;}}return 0;}function lengthInUTF8Bytes(a){return encodeURIComponent(a.replace(/\r/g,"")).replace(/%0A/g,"UU").replace(/%[A-F\d]{2}/g,"U").length;}function analyzeUTF8(f,a){var c=lengthInUTF8Bytes(f);var d=c-a;if(d>0){var b=c/f.length;return Math.round(d/b);}return 0;}function searchMonth(g,f){var c=g.toLowerCase();var b=[];if(f){b=["january","february","march","april","may","june","july","august","september","october","november","december"];}else{b=["jan","feb","march","april","may","june","july","aug","sept","oct","nov","dec"];}var a=0;for(var d=0;d<b.length();d++){a=c.indexOf(b[d],0);if(a>=0){a=a+b[d].length;while(g.charAt(a)==" "){a++;}return a;}}return -1;}function getTimeStartIdx(d){var f=0,b=0;var a=window.dateformat.replace(/f[mx]|"/gi,"");if(a=="DD de MONTH de YYYY"){b=d.lastIndexOf("de",0);f=2;}else{if(a=="DD MONTH, YYYY"){b=d.indexOf(",",0);f=2;}else{if(a=="DD-MONTH-YYYY"){b=d.lastIndexOf("-",0);f=1;}else{if(a=="DD MONTH YYYY"){b=searchMonth(d,true);f=1;}else{if(a=="DD. Mon YYYY"){b=searchMonth(d,false);f=1;}else{if(a=="YYYY년 MM월 DD일"){b=0;f=3;}else{b=0;f=1;}}}}}}for(var c=0;c<f;++c){b=d.indexOf(" ",b+1);if(b<0){break;}}return b;}function validate_date(f,c,d){var b=NLDate_parseString(f,c,d);var a;if(b==null){a={validflag:false};}else{a={validflag:true,value:getdatestring(b)};}return a;}function checkForQuirks(a,c,d){var b="";switch(a){case"mmdddate":case"visiblepassword":case"printeroffset":case"metricprinteroffset":b="Field Type Actually used! (Now removed from validation))";break;case"integer":case"posinteger":case"float":case"posfloat":case"nonnegfloat":if(c.indexOf("%")>=0){b="% found in non-percent type";}break;case"currency":case"currency2":case"poscurrency":case"nonnegcurrency":if(c.substring(1).search(/[\+\-\*\/]/g)>=0){b="Equation detected";}break;default:return;}if(b!==""){makeValidationQuirkLog(a,c,b,d);}}function hasV2clientScripts(){return(typeof(require)!=="undefined")&&(typeof(_clientScriptContext)!=="undefined")&&(_clientScriptContext.superScriptList.length>0);}function includedVersion2plusScript(){return hasV2clientScripts()||hasV2RecordOwnerEventHandler();}function hasV2RecordOwnerEventHandler(){return(typeof(require)!=="undefined")&&(typeof(_eventHandlerModules)!=="undefined")&&(_eventHandlerModules.length>0);}function _getCurrentScriptId(){try{return includedVersion2plusScript()?require("N/internal/reflet").getScript().scriptId:window.NLScriptId;}catch(a){}}function getBooleanValidationResult(a){return(a===Object(a)&&a.hasOwnProperty("valid"))?a.valid:a;}function makeValidationQuirkLog(c,f,d,h){var a=h||"";var b=_getCurrentScriptId()||"(UI)";var g=(typeof nlapiGetRecordType!=="undefined")?nlapiGetRecordType():"?";nsServerCall(nsJSONProxyURL,"logValidationQuirk",[c,f,d,a,b,g]);}function _doValidate(j){var a=require("N/validator"),d=j.fieldId,f=j.type,g=j.value,h=j.minVal,i=j.maxVal,c=j.mandatory,b=j.scale;return a.validateField(d,f,g,false,false,null,h,i,undefined,c,b);}function validate_field(i,h,k,a,j,l,d,c,b){if((typeof validationFlowSwitch!=="undefined")&&validationFlowSwitch.usesNewPath&&(typeof require!=="undefined")&&checkForModuleDependency()){if(i.value!==undefined&&i.value!==""){var m=false;NS.form.setValid(false);var n=require("N/format");var g=n.parse(i.value,h);try{_doValidate({fieldId:i.name,type:h,value:g,minVal:j,maxVal:l,mandatory:d,scale:b});m=true;}catch(f){if(k){alert(f.message);}m=false;}finally{i.value=n.format(g,h);}if(!m){selectAndFocusField(i);}NS.form.setValid(m);return m;}}else{return old_validate_field(i,h,k,a,j,l,d,c,b);}}function getTotalDigitCount(a){a=a+"";if(a==""){return 0;}else{a=a.replace("-","");if(a.indexOf(".")>0){a=a.replace(/0*?$/,"").replace(".","");}return a.length;}}function selectAndFocusField(b){if(isIE){try{b.focus();b.select();}catch(a){}}else{setTimeout(function(){b.focus();b.select();},50);}}function setSelectionRange(b,c,f){if(b.setSelectionRange){b.focus();try{b.setSelectionRange(c,f);}catch(d){}}else{if(b.createTextRange){var a=b.createTextRange();a.collapse(true);a.moveEnd("character",f);a.moveStart("character",c);a.select();}}}function clearMultiSelect(b){if(isNLMultiDropDown(b)){getMultiDropdown(b).removeAll();}else{if(b.type=="select-multiple"){for(var a=b.length-1;a>=0;a--){b.options[a].selected=false;}}else{b.value="";if(b.form.elements[b.name+"_display"]!=null){b.form.elements[b.name+"_display"].value="";}}}}function getnamevaluelisttext(j,h,b){if(j==null||j.length==0){return"";}var g=j.split(String.fromCharCode(4));var a="";for(var f=0;f<g.length;f++){var c=g[f].split(String.fromCharCode(3));var d=c.length==5?c[4]:c[3];if((d!=null&&d.length>0)||b==true){if(!isValEmpty(a)){a+=h;}a+=c[2]+": "+d;}}return a;}function getnamevaluelistdata(g){if(g==null||g.length==0){return"";}var f=g.split(String.fromCharCode(4));var a="";for(var d=0;d<f.length;d++){if(d>0){a+=String.fromCharCode(4);}var c=f[d].split(String.fromCharCode(3));var b=c.length>3?c[3]:"";a+=c[0]+String.fromCharCode(3)+b;}return a;}function getnamevaluelistvalue(b,c){if(b==null||b.length==0){return null;}var f=b.split(String.fromCharCode(4));for(var d=0;d<f.length;d++){var a=f[d].split(String.fromCharCode(3));if(a[0].toLowerCase()==c.toLowerCase()){return a[3];}}return null;}function getnamevaluelistdisplayvalue(b,c){if(b==null||b.length==0){return null;}var f=b.split(String.fromCharCode(4));for(var d=0;d<f.length;d++){var a=f[d].split(String.fromCharCode(3));if(a[0].toLowerCase()==c.toLowerCase()){return a.length==5?a[4]:a[3];}}return null;}function setnamevaluelistvalue(b,c,f){if(b==null||b.length==0){return"";}var g=b.split(String.fromCharCode(4));for(var d=0;d<g.length;d++){var a=g[d].split(String.fromCharCode(3));if(a[0].toLowerCase()==c.toLowerCase()){a[3]=f;g[d]=a.join(String.fromCharCode(3));break;}}return g.join(String.fromCharCode(4));}function syncnamevaluelist(b){var a=b.form.elements[b.name+"_display"];a.value=getnamevaluelisttext(b.value,"\n",true);if(a.onchange){a.onchange();}}function syncpopupmachinefield(c,b,a,d){if(c==null){nlapiSetFieldValue(b,d);}else{if(a!=null){nlapiSetLineItemValue(c,b,a,d);}else{nlapiSetCurrentLineItemValue(c,b,d);}}}function NLNameValueList_onKeyPress(a,c,f){var d=getEventKeypress(a);if(d==32){var b=document.getElementById(c+"_helper_"+f);if(b&&b.click){b.click();}}return true;}function setDefaultIndex(c,d){if(isNLDropDown(c)){var b=getDropdown(c);if(!!b){var a=b.getIndexForValue(d);b.setDefaultIndex(a);}}}function synclist(f,g,d){if(isNLDropDown(f)){var b=getDropdown(f);if(b!=null){var a=b.getIndexForValue(g);b.setIndex(a,true);if(d){b.setDefaultIndex(a);f.setAttribute("defaultValue",g);}}}else{if(f.type=="select-one"){for(var c=0;c<f.length;c++){if(f.options[c].value==g){f.selectedIndex=c;if(d){f.options[c].defaultSelected=true;f.setAttribute("defaultValue",g);}break;}}}else{f.value=g;if(d){f.setAttribute("defaultValue",g);}}}}function syncpopup(g,j,c,f){var d,b;if(isNLDropDown(g)){b=getDropdown(g);var a=b.getIndexForValue(j);b.setIndex(a,true);if(f){b.setDefaultIndex(a);}}else{if(isNLMultiDropDown(g)){b=getMultiDropdown(g);b.setValues(j);}else{if(g.type=="select-one"||g.type=="select-multiple"){for(d=0;d<g.length;d++){if(g.options[d].value==j){g.selectedIndex=d;if(f){g.options[d].defaultSelected=true;}break;}}}else{if(isPopupSelect(g)){g.value=j;if(f){g.setAttribute("defaultValue",j);}var h=g.form.elements[g.name+"_display"];if(c!=null&&c.length>0){h.value=c;h.style.color="#000000";if(f){h.defaultValue=c;}}else{if(g.getAttribute("onlyAllowExactMatch")==null){h.value=h.type=="text"?_popup_help:_mult_popup_help;h.style.color="#999999";if(f){h.defaultValue=h.value;}}}if(h===document.activeElement&&h.value===_short_popup_help){h.value="";}}else{g.value=j;if(f){g.defaultValue=j;}}}}}}function syncmultiselectlist(k,b,h,c){clearMultiSelect(k);if(typeof b!="string"&&!isArray(b)){b=""+b;}if(isNLMultiDropDown(k)){if(typeof b!="string"){b=b.join(String.fromCharCode(5));}var l=getMultiDropdown(k);l.setValues(b,c);}else{if(k.type!="select-multiple"){k.form.elements[k.name].value=b;h=emptyIfNull(h);var a=h.indexOf(String.fromCharCode(5))!=-1?String.fromCharCode(5):"\n";var d=k.form.elements[k.name+"_labels"];if(d!=null){d.value=isValEmpty(b)?"":h.split(a).join(String.fromCharCode(5));}var m=k.form.elements[k.name+"_display"];if(m!=null&&k.getAttribute("onlyAllowExactMatch")==null){m.value=h?h.split(a).join("\n"):_mult_popup_help;}}else{if(typeof b=="string"){b=b.split(String.fromCharCode(5));}for(var g=0;g<b.length;g++){for(var f=0;f<k.length;f++){if(k.options[f].value==b[g]){k.options[f].selected=true;}}}}}}function syncradio(a,f,c){var b;var d;for(b=0;b<a.length;b++){d=a[b].value==f;a[b].checked=d;if(c){a[b].defaultChecked=d;}}}function getlisttext(c,d,a){if(isNLDropDown(c)){return getDropdown(c).getTextForValue(d);}if(c.type!="select-one"&&!a){return"";}for(var b=0;b<c.length;b++){if(c.options[b].value==d){return c.options[b].text;}}return"";}function getmultiselectlisttext(d,g,f){if(!f){f="<br>";}if(isNLMultiDropDown(d)){return getMultiDropdown(d).getSelectedTextFromValues(g,f);}else{if(d.type!="select-multiple"){return"";}else{var a=g.split(String.fromCharCode(5));var b="";for(var c=0;c<a.length;c++){if(c>0){b+=f;}b+=getlisttext(d,a[c],true);}return b;}}}function getradiotext(a,c){var b;for(b=0;b<a.length;b++){if(a[b].value==c){return a[b].textValue;}}return"";}function getRadioValue(a){var c="";if(typeof a.length=="undefined"){a=a.ownerDocument.getElementsByName(a.name);}for(var b=0;b<a.length;b++){if(a[b].checked==true){c=a[b].value;break;}}return c;}function getSelectedRadio(a){var c=null;if(typeof a.length=="undefined"){a=a.ownerDocument.getElementsByName(a.name);}for(var b=0;b<a.length&&c==null;b++){c=a[b].checked?a[b]:null;}return c;}function getSelectValue(b){var a;if(b.type!=null&&b.type=="select-one"){a=(b.options.length==0||b.selectedIndex==-1||b.selectedIndex>=b.options.length)?"":b.options[b.selectedIndex].value;}else{if(isMultiSelect(b)){a=getMultiSelectValues(b);}else{if(isNLDropDown(b)){a=getDropdown(b).getValue();}else{if(isNLMultiDropDown(b)){a=getMultiDropdown(b).getSelectedValues();}else{a=b.value;}}}}return a;}function getSelectValueArray(c){var a;if(c.type=="select-one"||c.type=="select-multiple"){a=new Array(c.length);for(var b=0;b<c.length;b++){a[b]=c.options[b].value;}}else{if(isNLDropDown(c)){a=getDropdown(c).valueArray;}else{if(isNLMultiDropDown(c)){a=getMultiDropdown(c).valueArray;}}}return a;}function getIndexForValue(c,d){var a=-1;if(c.type=="select-one"||c.type=="select-multiple"){for(var b=0;b<c.length;b++){if(c.options[b].value==d){a=b;break;}}}else{if(isNLDropDown(c)){a=getDropdown(c).getIndexForValue(d);}else{if(isNLMultiDropDown(c)){a=getMultiDropdown(c).getIndexForValue(d);}}}if(typeof(a)=="undefined"){a=-1;}return a;}function getSelectTextForValue(c,d){if(!isBackend){var a=getSelectValueArray(c);var b;for(b=0;b<a.length;b++){if(a[b]==d){return getSelectTextAtIndex(c,b);}}return null;}else{return"";}}function addSelectOption(g,b,k,h,c,d,i){if(!isBackend){if(isNLDropDown(b)){var j=getDropdown(b,d);if(j==null){return;}j.addOption(k,h,i);if(c!==false){var i=j.getIndexForValue(h);j.setIndex(i,true);}}else{if(isNLMultiDropDown(b)){var j=getMultiDropdown(b,d);if(j==null){return;}j.addOption(k,h,c,i);}else{if(isPopupSelect(b)){throw"Unsupported operation: Adding options to a popup select";}else{var a=g.createElement("OPTION");a.text=k;a.value=h;if(isIE){if(typeof(i)=="undefined"){i=b.length;}b.add(a,i);}else{var f=null;if(typeof(i)!="undefined"&&i>=0&&i<b.length){f=b.options[i];}b.add(a,f);}if(c!==false){a.selected=true;if(isIE){b.selectedIndex=i;}}}}}}}function getSelectTextArray(c){var a;if(c.type=="select-one"||c.type=="select-multiple"){a=new Array(c.length);for(var b=0;b<c.length;b++){a[b]=c.options[b].text;}}else{if(isNLDropDown(c)){a=getDropdown(c).textArray;}else{if(isNLMultiDropDown(c)){a=getMultiDropdown(c).textArray;}}}return a;}function getSelectText(a,b){var c=getSelectValue(a);if(a.type=="select-one"){return(a.options.length==0||a.selectedIndex==-1||a.selectedIndex>=a.options.length)?null:a.options[a.selectedIndex].text;}else{if(isNLDropDown(a)){return getDropdown(a).getText();}else{if(isMultiSelect(a)||isPopupMultiSelect(a)){return getMultiSelectText(a,null,b);}else{if(isPopupSelect(a)){return isValEmpty(c)?"":getFormElement(a.form,a.name+"_display").value.replace(/\s$/,"");}else{if(isDisplayOnlySelect(a)){return getInlineTextValue(document.getElementById(a.name+"_displayval"));}else{return a.text;}}}}}}function setSelectValue(c,d){if(window.virtualBrowser){c.value=d;}else{if(isNLDropDown(c)){var j=getDropdown(c);var h=j.getIndexForValue(d);if(h==null){return false;}j.setIndex(h,true);if(j.isOpen){j.setCurrentCellInMenu(j.divArray[h]);}}else{if(isNLMultiDropDown(c)){var j=getMultiDropdown(c);var h=j.getIndexForValue(d);if(h==null){return false;}j.setIndex(h);}else{if(c.type=="select-one"){var b=c.options;for(var g=0;g<b.length;g++){if(b[g].value==d){c.selectedIndex=g;return true;}}return false;}else{if(c.type=="select-multiple"){var a=c.options;var k=false;for(var g=0;g<a.length;g++){a[g].selected=a[g].value==d;k=k||a[g].value==d;}return k;}else{c.value=d;if(d.length==0&&isPopupSelect(c)){var f=c.form.elements[c.name+"_display"];f.value=f.type=="text"?_popup_help:_mult_popup_help;f.style.color="#999999";}}}}}}return true;}function addMultiSelectValue(c,d,b){if(isNLMultiDropDown(c)){var j=getMultiDropdown(c);var g=j.getIndexForValue(d);j.addIndex(g);}else{if(c.type=="select-multiple"){var a=c.options;for(var f=0;f<a.length;f++){if(a[f].value==d){a[f].selected=true;}}}else{var h=c.value.split(String.fromCharCode(5));for(var f=0;f<h.length;f++){if(h[f]==d){return;}}c.form.elements[c.name+"_display"].style.color="#000000";if(h.length==0||h[0].length==0){c.value=d;c.form.elements[c.name+"_display"].value=b;c.form.elements[c.name+"_labels"].value=b;}else{c.value+=String.fromCharCode(5)+d;c.form.elements[c.name+"_labels"].value+=String.fromCharCode(5)+b;var k=c.form.elements[c.name+"_display"].value.split(/\n|\r/);if(k.length==h.length){c.form.elements[c.name+"_display"].value+="\n"+b;}else{k[h.length]=b;c.form.elements[c.name+"_display"].value=k.join("\n");}}}}}function getCurrentMultiSelectUserInputValue(b){var a=getSelectedTextRange(b)[0];var f=b.value.substr(0,a);var d=Math.max(f.lastIndexOf("\n"),f.lastIndexOf("\r"))+1;var c=b.value.substr(a).search(/\n|\r/);c=c==-1?b.value.length:a+c;return b.value.substring(d,c);}function getSelectValueForText(d,a){var b=getSelectTextArray(d);for(var c=0;c<b.length;c++){if(b[c]==a){return getSelectValueAtIndex(d,c);}}return null;}function deleteAllSelectOptions(a,b){if(isNLDropDown(a)){getDropdown(a,b).deleteAllOptions();}else{if(isNLMultiDropDown(a)){getMultiDropdown(a,b).deleteAllOptions();}else{if(a.type=="select-one"||a.type=="select-multiple"){a.options.length=0;}else{if(a.form.elements[a.name+"_display"]!=null){a.form.elements[a.name+"_display"].value="";a.value="";}}}}}function deleteOneSelectOption(f,d,c){if(isNLDropDown(f)){getDropdown(f).deleteOneOption(d,c);}else{if(isNLMultiDropDown(f)){getMultiDropdown(f).deleteOneOption(d);}else{if(f.type=="select-one"||f.type=="select-multiple"){var b=f.options;for(var a=0;a<b.length;a++){if(b[a].value==d){b[a]=null;}}}else{if(f.form.elements[f.name+"_display"]!=null){f.form.elements[f.name+"_display"].value="";f.value="";}}}}}function getSelectIndex(a,b){if(isNLDropDown(a)){return getDropdown(a,b).getIndex();}else{return a.selectedIndex;}}function setSelectIndex(a,b){if(isNLDropDown(a)){return getDropdown(a).setIndex(b,true);}else{if(isNLMultiDropDown(a)){return getMultiDropdown(a).setIndex(b);}else{a.selectedIndex=b;}}}function setMultiSelectValues(a,b){syncmultiselectlist(a,b);}function getMultiSelectValues(b,c){var d=null;if(isMultiSelect(b)){if(isNLMultiDropDown(b)){d=getMultiDropdown(b).getSelectedValues();}else{d="";for(var a=0;a<b.length;a++){if(b.options[a].selected){d+=((d==""?"":String.fromCharCode(5))+b.options[a].value);}}}}else{d=b.value;}return c?(isValEmpty(d)?[]:d.split(String.fromCharCode(5))):d;}function getMultiSelectText(c,a,d){var h="";var g=d?String.fromCharCode(5):", ";if(isMultiSelect(c)){g=a?"\n":g;if(isNLMultiDropDown(c)){h=getMultiDropdown(c).getSelectedText(g);}else{var b,f=0;for(b=0;b<c.length;b++){if(c.options[b].selected){h+=((f++==0?"":(g))+c.options[b].text);}}}}else{if(isPopupMultiSelect(c)){h=getFormElement(c.form,c.name+"_labels").value;if(h!=null&&g!=String.fromCharCode(5)){h=h.replace(new RegExp(String.fromCharCode(5),"g"),g);}}else{h=c.text;}}return d?(isValEmpty(h)?[]:h.split(g)):h;}function updateMultiSelectValue(d,k,b,j,f){d.value=b;f.value=j;var h=j.split(String.fromCharCode(5));var a="",c=0;for(var g=0;g<h.length;g++){a+=((c==0?"":"\n")+h[g]);c++;}k.value=a;}function setSelectOptionText(f,d,h,g){if(isNLDropDown(f)){var a=getDropdown(f,g);a.setOptionText(d,h);}else{if(f.type=="select-one"||f.type=="select-multiple"){var c=f.options;for(var b=0;b<c.length;b++){if(c[b].value==d){c[b].text=h;}}}}}function getCascadedStyle(b,d,c){if(b.currentStyle){return b.currentStyle[d];}else{if(window.getComputedStyle){if(b.nodeType!=1){return null;}var a=window.getComputedStyle(b,"");if(a){return a.getPropertyValue(c);}}}return null;}function isFocusable(a){if(a==null||(typeof a.type=="undefined"&&!isNLDropDownSpan(a))||a.type=="hidden"||a.disabled||a.type=="button"){return false;}return elementIsFocusable(a);}function elementIsFocusable(b){while(b!=null){var a=getCascadedStyle(b,"visibility","visibility");var c=getCascadedStyle(b,"display","display");if(c=="none"||a=="hidden"||a=="hide"){return false;}b=b.parentNode;}return true;}function NLIsButton(a){return a&&(a.tagName=="BUTTON"||(a.tagName=="INPUT"&&(a.type=="submit"||a.type=="button"||a.type=="reset")));}function NLDisableButton(b,c){b.disabled=c;if(b.className.indexOf("nlbutton")>=0||b.className.indexOf("bgbutton")>=0||b.className.indexOf("nlinlineeditbutton")>=0){b.className=b.className.split("Disabled")[0]+(c?"Disabled":"");}if((b.className.indexOf("bntBgT")>=0)&&(b.name)){var a=document.getElementById("tr_"+b.name);if(a&&a.className){if(c){if(a.className.indexOf("Dis")<0){a.className=a.className+"Dis";}}else{a.className=a.className.replace("Dis","");}}}}function NLIsSubmitButton(a){return a&&(a.tagName=="INPUT")&&(a.type=="submit");}function NLInvokeButton(a){if(a){if(a.disabled){return;}a.click();}}function NLAddButtonDisabledMessage(b,a,k){var d=document.getElementById(b);var c=document.getElementById(a);if(d==null||c==null){return;}var g=findGlobalPosX(d);var f=findGlobalPosY(d);var h=d.offsetWidth;var j=d.offsetHeight;var i=document.createElement("div");i.style.position="absolute";i.style.left=g+"px";i.style.top=f+"px";i.style.width=h+"px";i.style.height=j+"px";i.style.background="#000000";i.style.opacity="0";i.style.zindex="100";attachEventHandler("mouseover",i,function(){nlShowMessageTooltip(c,k);});attachEventHandler("mouseout",i,function(){closePopup();});attachEventHandler("click",i,function(){if(!c.disabled){c.onClick();}});d.appendChild(i);}function getSubmitButton(b,d){var f=document.getElementsByName(b);for(var c=0;c<f.length;c++){var a=f[c];if(NLIsSubmitButton(a)&&(d==null||d==a.value)){return a;}}return null;}function isDisplayOnlySelect(a){return a!=null&&a.type=="hidden"&&document.getElementById(a.name+"_displayval")!=null;}function isPopupSelect(a){return a!=null&&a.type=="hidden"&&getFormElement(a.form,a.name+"_display")!=null&&getFormElement(a.form,a.name+"_display").type=="text";}function isPopupMultiSelect(a){return a!=null&&a.type=="hidden"&&getFormElement(a.form,a.name+"_display")!=null&&getFormElement(a.form,a.name+"_display").type=="textarea"&&getFormElement(a.form,a.name+"_labels")!=null;}function NLPopupSelect_setExactMatchQuery(c,a){c.setAttribute("exactMatchQuery",a?"T":"F");}function NLPopupSelect_getExactMatchQuery(a){return a.getAttribute("exactMatchQuery")=="T";}function isSelect(a){return a!=null&&(a.type=="select-one"||isNLDropDown(a));}function isMultiSelectInput(a){return a!=null&&a.type=="hidden"&&document.getElementById(a.name+"_multiselect")!=null;}function isNLDropDown(a){return a!=null&&a.className&&a.className.indexOf("nldropdown")>=0;}function isNLDropDownSpan(a){return a!=null&&a.tagName=="SPAN"&&window.getDropdown!=null&&getDropdown(a)!=null;}function isMultiSelect(a){return a!=null&&(isNLMultiDropDown(a)||a.multiple||a.type=="select-multiple");}function isNLMultiDropDown(a){return a!=null&&a.getAttribute&&!isValEmpty(a.getAttribute("nlmultidropdown"));}function isRichTextEditor(a){return a!=null&&window.getHtmlEditor!=null&&getHtmlEditor(a.name)!=null;}function isRichTextEditorUnregisteredSafe(a){if(a==null){return false;}return a.className!=null&&a.className.indexOf("rteditor")!=-1;}function isSummaryField(a){return a.className&&a.className.indexOf("nlsummary")>=0;}function resetlist(b){if(b!=null){if(b.type=="select-one"||b.type=="select-multiple"){var a;for(a=0;a<b.length;a++){if(b.options[a].defaultSelected){b.selectedIndex=a;return;}}b.selectedIndex=0;}else{if(isNLDropDown(b)){getDropdown(b).resetDropDown();}else{if(isNLMultiDropDown(b)){getMultiDropdown(b).resetDropDown();}else{b.value=b.defaultValue;if(b.form.elements[b.name+"_display"]!=null){b.form.elements[b.name+"_display"].value=b.form.elements[b.name+"_display"].defaultValue;}}}}}}function setFieldFocus(a){if(isSelect(a)||isMultiSelect(a)||isPopupSelect(a)||isPopupMultiSelect(a)){setSelectFocus(a);}else{if(window.getHtmlEditor!=null&&window.getHtmlEditor(a.name)!=null){window.getHtmlEditor(a.name).setFocus();}else{if(isFocusable(a)){a.focus();}}}}function setSelectFocus(a,b){if(a!=null){if(a.type=="select-one"||a.type=="select-multiple"){if(isFocusable(a)){a.focus();}}else{if(isNLDropDown(a)){if(isFocusable(getDropdown(a,b).getContainer())){getDropdown(a,b).setFocus();}}else{if(isNLMultiDropDown(a)){if(isFocusable(getMultiDropdown(a,b).getContainer())){getMultiDropdown(a,b).setFocus();}}else{if(isFocusable(a.form.elements[a.name+"_display"])){a.form.elements[a.name+"_display"].focus();}}}}}}function restoreSelectToOriginalValue(b,c){if(b!=null){if(b.type=="select-one"||b.type=="select-multiple"){var a=b.getAttribute("valuewhenrendered");if(a!=null&&a.length>0){setSelectValue(b,a);}}else{if(isNLDropDown(b)){getDropdown(b,c).restoreToOriginalValue();}}}}function getSelectValueAtIndex(b,a){if(b!=null){if(b.type=="select-one"||b.type=="select-multiple"){if((b.options!=null)&&(b.options.length>a)){return b.options[a].value;}else{return null;}}else{if(isNLDropDown(b)){return getDropdown(b).getValueAtIndex(a);}else{if(isNLMultiDropDown(b)){return getMultiDropdown(b).getValue(a);}}}}}function getSelectTextAtIndex(b,a){if(b!=null){if(b.type=="select-one"||b.type=="select-multiple"){if((b.options!=null)&&(b.options.length>a)){return b.options[a].text;}else{return null;}}else{if(isNLDropDown(b)){return getDropdown(b).getTextAtIndex(a);}else{if(isNLMultiDropDown(b)){return getMultiDropdown(b).getText(a);}}}}}function setNLCheckboxValue(a,b){if(!a){return;}if(typeof(b)=="string"){a.checked=b=="T";}else{a.checked=b;}NLCheckboxOnChange(a);}function getNLCheckboxValue(a){if(!a){return;}return a.checked;}function getNLCheckboxSpan(a){var b=a.parentNode;if(b&&b.nodeName=="SPAN"&&b.className&&(b.className.indexOf("checkbox")==0)){return b;}return null;}function setNLCheckboxDisabled(c,b){if(!c||c.type!="checkbox"){return;}var a="checkbox"+(b?"_disabled":"")+(c.checked?"_ck":"_unck");c.disabled=b;var d=getNLCheckboxSpan(c);if(d){d.className=a;}}function setNLCheckboxReadOnly(c,a){if(!c||c.type!="checkbox"){return;}var b="checkbox"+(a?"_read":"")+(c.checked?"_ck":"_unck");c.readonly=a;var d=getNLCheckboxSpan(c);d.className=b;}function NLCheckboxOnClick(g){var f=g.className;var b=null;for(var d=0;d<g.childNodes.length;d++){if(g.childNodes[d].type=="checkbox"){b=g.childNodes[d];break;}}if(!b||b.disabled){return;}if(b.type=="checkbox"&&b.checked){g.className=g.className.replace("_ck","_unck");b.checked=false;}else{g.className=g.className.replace("_unck","_ck");b.checked=true;}b.focus();var c=b.checked;if(b.onclick){b.onclick();}var a=b.checked;if(c!=a){g.className=f;}else{if(b.onchange){b.onchange();}}}function NLCheckboxOnChange(a){if(!a){return;}var b=getNLCheckboxSpan(a);if(b){if(a.checked){b.className=b.className.replace("_unck","_ck");}else{b.className=b.className.replace("_ck","_unck");}}}function NLCheckboxSetParentState(a,c){if(!a){return;}var b=getNLCheckboxSpan(a);if(b){if(c){b.className=b.className.replace("_unck","_ck");}else{b.className=b.className.replace("_ck","_unck");}}}function NLCheckboxOnKeyPress(a){if(window.event){a=getEvent(a);if(a.keyCode==32&&a.srcElement){if(a.srcElement.onclick){a.srcElement.onclick();}NLCheckboxSetParentState(a.srcElement,!a.srcElement.checked);}}return true;}function getNLSummaryFieldContent(c){if(!isSummaryField(c)){return"";}var a=(c.document)?c.document:document;var b=a.getElementById(c.id+"_val");if(b&&b.parentNode){return b.parentNode.innerHTML;}return"";}function setNLSummaryFieldTextValue(c,d){if(!isSummaryField(c)){return"";}var a=(c.document)?c.document:document;var b=a.getElementById(c.id+"_val");if(b){b.innerHTML=d;}}function getNLSummaryFieldTextValue(c){if(!isSummaryField(c)){return"";}var a=(c.document)?c.document:document;var b=a.getElementById(c.id+"_val");if(b){return b.innerHTML;}return"";}function setNLSummaryFieldDisabled(c,b){if(!isSummaryField(c)){return;}c.disabled=b;var a=(c.document)?c.document:document;var d=a.getElementById(c.name+"_helper_popup");if(d!=null){d.style.visibility=b?"hidden":"inherit";}}function isNLNumericOrCurrencyDisplayField(a){if(!a){return false;}if(!(isNumericField(a)||isCurrencyField(a))){return false;}return(a.name.indexOf("_formattedValue")>0);}function getNLNumericOrCurrencyDisplayField(b){if(!b){return null;}var a=b.name+"_formattedValue";return findNLNumericFieldByName(b,a);}function getNLNumericOrCurrencyValueField(b){if(!b){return null;}var a=b.name.replace("_formattedValue","");return findNLNumericFieldByName(b,a);}function findNLNumericFieldByName(c,a){if(!c.form){var d=c.ownerDocument.getElementsByName(a);for(var b=0;b<d.length;b++){if(d[b].parentNode==c.parentNode){return d[b];}}return c.ownerDocument.getElementById(a);}return c.form.elements[a];}function isCurrencyField(b){if(!b){return false;}var a="";if(typeof b.getAttribute!="undefined"){a=b.getAttribute("dataType");}if(a=="currency"||a=="poscurrency"||a=="currency2"||a=="nonnegcurrency"){return true;}return false;}function setNLCurrencyValue(a,c){a.value=c;var b=getNLNumericOrCurrencyDisplayField(a);if(!b){return;}b.value=NLNumberToString(c);}function isNumericField(b){if(!b){return false;}var a="";if(typeof b.getAttribute!="undefined"){a=b.getAttribute("dataType");}if(a=="float"||a=="posfloat"||a=="nonnegfloat"||a=="integer"||a=="posinteger"||a=="rate"||a=="ratehighprecision"||a=="percent"||a=="dynamicprecision"){return true;}return false;}function isInlineHTMLField(a){return a&&typeof a.getAttribute!="undefined"&&a.getAttribute("dataType")==="inlinehtml";}function setNLNumericValue(a,c){a.value=c;var b=getNLNumericOrCurrencyDisplayField(a);if(!b){return;}b.value=NLNumberToString(c);}function setNLNumericOrCurrencyFieldDisabled(a,c){var b=getNLNumericOrCurrencyDisplayField(a);if(!b){return;}b.disabled=c;}function getNLNumericOrCurrencyFieldDisabled(a){var b=getNLNumericOrCurrencyDisplayField(a);if(!b){return false;}return b.disabled;}function setDefaultOrNotRequired(a,b){setRequired(a,b?getRequired(a):false);}function hasAttribute(b,a){if(isNLDropDown(b)){return getDropdown(b).hasAttribute(a);}else{if(isNLMultiDropDown(b)){return getMultiDropdown(b).hasAttribute(a);}else{if(window.getHtmlEditor!=null&&getHtmlEditor(b.name)!=null){return getHtmlEditor(b.name).hasAttribute(a);}else{return(b.getAttribute("flags")&a)!=0;}}}}function disableField(c,f){if(!isBackend){if(c==null){return;}if(!isSelect(c)&&c.length>1){for(var b=0;b<c.length;b++){if(c[b].type=="radio"){disableField(c[b],f);}}return;}else{if(isSelect(c)||isPopupSelect(c)||isMultiSelect(c)||isPopupMultiSelect(c)){disableSelect(c,f);}else{if(window.getHtmlEditor!=null&&getHtmlEditor(c.name)!=null){getHtmlEditor(c.name).setDisabled(f);}else{if(NLIsButton(c)){NLDisableButton(c,f);}else{if(c.type=="checkbox"){setNLCheckboxDisabled(c,f);}else{if(isSummaryField(c)){setNLSummaryFieldDisabled(c,f);}else{if(isNumericField(c)||isCurrencyField(c)){setNLNumericOrCurrencyFieldDisabled(c,f);}else{c.disabled=f;var a=(c.document)?c.document:document;var d=a.getElementById(c.name+"_helper_calendar");if(d!=null){d.style.visibility=f?"hidden":"inherit";}}}}}}}}}updateFieldEditabilityFlags(c,"sp_disabledField",f);}function setFieldReadOnly(a,b){if(a!=null&&a.type=="textarea"){a.readOnly=b;}updateFieldEditabilityFlags(a,"sp_readOnlyField",b);}function getFieldDisabled(b){if(b==null){return;}if(!isSelect(b)&&b.length>1){for(var a=0;a<b.length;a++){if(b[a].type=="radio"){return b[a].disabled;}}}else{if(isSelect(b)||isPopupSelect(b)||isMultiSelect(b)){if(b.type=="select-one"||b.type=="select-multiple"){return b.disabled;}else{if(isNLDropDown(b)){return getDropdown(b,window).disabled;}else{if(isNLMultiDropDown(b)){return getMultiDropdown(b,window).disabled;}else{if(isPopupSelect(b)){return getFormElement(b.form,b.name+"_display").disabled;}}}}}else{if(window.getHtmlEditor!=null&&getHtmlEditor(b.name)!=null){return getHtmlEditor(b.name).disabled;}else{if(isNumericField(b)||isCurrencyField(b)){return getNLNumericOrCurrencyFieldDisabled(b);}else{return b.disabled;}}}}return false;}function isDisplayOnlyField(a){if(a==null){return;}if(isDisplayOnlySelect(a)){return true;}else{if(a.type=="hidden"&&document.getElementById(a.name+"_val")!=null){return true;}}return false;}function setOptionsFromMachineField(machine_name,field_name,selectObject,alternate_label,test_field,test_value){deleteAllSelectOptions(selectObject,window);var doc=window.document;var mch=eval(machine_name+"_machine");addSelectOption(doc,selectObject,"","",true,window);var bNewOptions=false;for(var i=1;i<=getLineCount(machine_name);i++){if(mch.getMachineIndex()==i||(test_field!=null&&getEncodedValue(machine_name,i,test_field)!=test_value)){continue;}bNewOptions=true;addSelectOption(doc,selectObject,getEncodedValue(machine_name,i,alternate_label!=null?alternate_label:field_name+"_display"),getEncodedValue(machine_name,i,field_name),false,window);}return bNewOptions;}function getSyncFunctionName(fldname,machine){var syncFuncName="Sync"+fldname;if(machine!=null){var machSyncFunc=syncFuncName+machine;if(eval("window."+machSyncFunc)!=null){return machSyncFunc;}}return syncFuncName;}function safeSetDocumentLocation(a){try{document.location=a;}catch(b){}}function addParamToURL(a,d,c,b){if(a==null){return null;}if(a.length&&a.charAt(a.length-1)=="#"){a=a.substring(0,a.length-1);}if(a.length&&a.indexOf("#")>-1){a=a.substring(0,a.indexOf("#"));}if(isValEmpty(d)){return a;}if(b==true){a=removeParamFromURL(a,d);}return addNextParamPrefixToURL(a)+d+"="+emptyIfNull(c);}function addNextParamPrefixToURL(a){return a+(a.indexOf("?")==-1?"?":"&");}function removeParamFromURL(b,f){var a="&";var d=b.indexOf("&"+f+"=");if(d==-1){d=b.indexOf("?"+f+"=");a="?";}if(d!=-1){var c=b.indexOf("&",d+1);return b.substring(0,d)+(c>0?(a=="?"?"?"+b.substr(c+1):b.substr(c)):"");}return b;}function formEncodeURLParams(c){var b="";for(var a in c){b+=(isValEmpty(b)?"":"&")+encodeURIComponent(a)+"="+encodeURIComponent(emptyIfNull(c[a]));}return b;}function downloadMedia(b){var a="/core/media/previewmedia.nl?id="+b+"&_xd=T";preview(a,"prevmedia");}function previewTemplate(c,a){var b="/app/crm/common/merge/previewtemplate.nl?id="+c;if(!isValEmpty(a)){b=addParamToURL(b,"entity",a);}preview(b,"previewtemplate");}function siteMedia(d,c,a){if(c){d=d.substr(d.lastIndexOf("/")+1);}var b="/app/site/media/sitemedia.nl?id="+d;preview(b,"sitemedia");}function getCookieVal(b){var a=document.cookie.indexOf(";",b);if(a==-1){a=document.cookie.length;}return unescape(document.cookie.substring(b,a));}function GetCookie(d){var b=d+"=";var g=b.length;var a=document.cookie.length;var f=0;while(f<a){var c=f+g;if(document.cookie.substring(f,c)==b){return getCookieVal(c);}f=document.cookie.indexOf(" ",f)+1;if(f==0){break;}}return null;}function getStickyTag(d){var c=GetCookie("stickytags");if(c!=null){var a=c.indexOf(","+d+":")+1;if(a>=1){var f=c.indexOf(",",a);if(f<0){f=c.length;}return unescape(c.substring(a+d.length+1,f));}}return null;}function addStickyTagToUrl(b,a){return b+(b.indexOf("?")>=0?"&t=":"?t=")+getStickyTag(a);}function redirectToStickyPage(c,a,b){var f=addStickyTagToUrl(c,a);try{if(typeof(b)=="number"){parent.frames[b].document.location=f;}else{if(b){parent.document.location=f;}else{document.location=f;}}}catch(d){}}var SelectKeyPressMaxKeyPause=2000;var SelectKeyPressTypedString="",SelectKeyPressTimeoutID=null;function SelectKeyPressHandler(d,b){var a=String.fromCharCode(getEventKeypress(d)).toUpperCase(),c;if(!(a>=" "&&a<="_")){SelectKeyPressTypedString="";return true;}if(SelectKeyPressTimeoutID!=null){window.clearTimeout(SelectKeyPressTimeoutID);}SelectKeyPressTimeoutID=window.setTimeout("SelectKeyPressTimeout()",SelectKeyPressMaxKeyPause);SelectKeyPressTypedString+=a;if(b){if(SelectKeyPressTypedString.length==1){c=SelectKeyPressLookupFirst(d,SelectKeyPressTypedString);}else{c=SelectKeyPressLookupNext(d,SelectKeyPressTypedString);}}else{c=SelectKeyPressLookupLinear(d,SelectKeyPressTypedString);}setEventPreventDefault(d);if(c!=-1){getEventTarget(d).selectedIndex=c;getEventTarget(d).onchange();}return false;}function SelectKeyPressTimeout(){SelectKeyPressTypedString="";SelectKeyPressTimeoutID=null;}function SelectKeyPressLookupFirst(h,g){var b=getEventTarget(h);var c=b.options;var a=0;var f=c.length;while(f-a>1){var d=Math.floor((f+a)/2);if(g.charAt(0)<=c(d).text.charAt(0).toUpperCase()){f=d;}else{a=d;}}while(f>0&&g.charAt(0)==c(f-1).text.charAt(0).toUpperCase()){--f;}if(f<c.length&&g.charAt(0)==c(f).text.charAt(0).toUpperCase()){return f;}else{return -1;}}function SelectKeyPressLookupNext(f,d){var a=getEventTarget(f);var c=a.options;var b=a.selectedIndex;while(b<c.length-1&&c(b).text.toUpperCase()<d){++b;}if(b<c.length-1&&c(b).text.substr(0,d.length).toUpperCase()==d){return b;}else{return -1;}}function SelectKeyPressLookupLinear(f,d){var a=getEventTarget(f);var b=a.options;for(var c=0;c<b.length;++c){if(b(c).text.substr(0,d.length).toUpperCase()==d){return c;}}return -1;}function disableFilter(b,a,d,c){if(getRadioValue(b)==a){d.disabled=true;if(c){c.disabled=true;}}else{d.disabled=false;if(c){c.disabled=false;}}}var NLDate_pnDaysInMonths=[31,28,31,30,31,30,31,31,30,31,30,31];function NLDate_getLastDayOfMonth(b){var a=b.getMonth();var d=NLDate_pnDaysInMonths[a];if(a==1){var c=b.getYear();if((c%400==0)||((c%4==0)&&(c%100!=0))){d++;}}return d;}function setDisabledState(a,c){var f=document.getElementById(a),d;if(typeof f.disabled!="undefined"){f.disabled=!c;return;}var b=document.getElementById(a).getElementsByTagName("INPUT");for(d=0;d<b.length;d++){if(b[d].name.indexOf("_send")==-1){b[d].disabled=!c;}}b=document.getElementById(a).getElementsByTagName("A");for(d=0;d<b.length;d++){if(!c&&!b[d].disabled){b[d].enabledonclick=b[d].onclick;b[d].onclick=function(){return false;};}else{if(c&&b[d].enabledonclick!=null&&b[d].disabled){b[d].onclick=b[d].enabledonclick;}}b[d].disabled=!c;}}function nlOpenWindow(c,f,b,a,d,g){if(window.doPageLogging){logStartOfRequest("popup");}if(isValEmpty(b)){return window.open(c,f);}else{if(isNaN(parseInt(b))){return window.open(c,f,b);}else{if(isIE){return window.open(c,f,"scrollbars="+(g?"yes":"no")+",width="+Math.min(screen.availWidth,b)+",height="+Math.min(screen.availHeight-40,a)+",left="+Math.min(screen.availWidth-b,getObjectLeft(d))+",top="+Math.min((screen.availHeight-40)-a,getObjectTop(d))+",resizable=yes");}else{return window.open(c,f,"scrollbars="+(g?"yes":"no")+",width="+b+",height="+a+",resizable=yes");}}}}function nlExtOpenDivWindow(b,a,n,c,h,m,j,f,g,p,d){var i="<div id='"+b+"_framediv'></div>";if(f!=null&&typeof f!="undefined"){i=f;}if(p!=null&&typeof p!="undefined"){i=p+"<div style='width:100%;float:left;clear:left;' id='"+b+"_framediv'>";}var o={xtype:"box",id:b+"_frame",autoEl:"center",cls:"uir-ext-window-body"};o[i instanceof HTMLElement?"contentEl":"html"]=i;var l={title:(m!=undefined?m:b),id:b,name:b,stateful:false,modal:true,autoScroll:false,style:"background-color: #FFFFFF;",bodyStyle:"background-color: #FFFFFF;",resizable:true,width:a,height:n,alignTarget:g,defaultAlign:g?"tl-tl?":"c-c",listeners:j,layout:"fit",items:[o]};NS.jQuery.extend(l,d);var k=new Ext.Window(l);k.show();k.syncSize();return k;}function nlOpenIframe(b,f,d){if(!d){d={};}var a=NS.jQuery.Deferred();var g=f;var c=NS.jQuery("#"+g);if(c.length==0){NS.jQuery("<iframe/>",{id:g,tabindex:-1,style:"display: none",height:0,width:0}).appendTo("body");c=NS.jQuery("#"+g);if(d.onload){c.on("onload",function(i,h){d.onload(h);});}c.load(function(){a.resolve();NS.jQuery(this).trigger("onload",[NS.jQuery(this)]);});if(d.beforeclose){c.on("beforeclose",function(h){d.beforeclose();});}}c.load(a.resolve);c.data("iframeid",g);c.attr("src",b);return a.promise();}function getObjectLeft(a){var b=0;while(a!=null&&a!=document.body){b+=a.offsetLeft;a=a.offsetParent;}return b+(isIE?window.screenLeft:window.screenX+window.outerWidth-window.innerWidth);}function getObjectTop(a){var b=0;while(a!=null&&a!=document.body){b+=a.offsetTop;a=a.offsetParent;}if(isIE){return b+window.screenTop;}var c=0;if(typeof window.statusbar!="undefined"&&window.statusbar!=null&&window.statusbar.visible){c=20;}return b+window.screenY+window.outerHeight-window.innerHeight-c;}function setFieldVisibility(b,a){var c=document.getElementById(b);visible(c,a);}function setLabelVisibility(b,a){var c=document.getElementById(b+"_lbl");visible(c,a);}function setFieldAndLabelVisibility(b,a){setLabelVisibility(b,a);setFieldVisibility(b,a);}function showHelperText(b,a){var c=document.getElementById(b+"_hlp");display(c,a);}function showLabel(b,a){if(!isBackend){var d=document.getElementById(b+"_lbl");if(a){var c=!!NS&&!!NS.UI&&!!NS.UI.Helpers&&!!NS.UI.Helpers.getClosestAncestorFromClass&&NS.UI.Helpers.getClosestAncestorFromClass(document.getElementById(b),"uir-field-wrapper");if(c){display(c,a);}}display(d,a);}}function getLabel(a){if(!isBackend){var b=document.getElementById(a+"_lbl");if(b==null){return null;}else{if(b.getElementsByTagName("a")!=null&&b.getElementsByTagName("a").length==1){return b.getElementsByTagName("a").item(0).innerHTML;}else{return b.innerHTML;}}}}function showFieldAndLabel(b,a){if(!isBackend){var c=!!NS&&!!NS.UI&&!!NS.UI.Helpers&&!!NS.UI.Helpers.getClosestAncestorFromClass&&NS.UI.Helpers.getClosestAncestorFromClass(document.getElementById(b),"uir-field-wrapper");if(!!c){display(c,a);}var d=!!NS&&!!NS.jQuery&&NS.jQuery(document.getElementById(b)).closest(".uir-combined-field-radio");if(!!d){NS.jQuery(d).find("*").toggle(a);}showLabel(b,a);showField(b,a);}}var ns_tabUtils=(function(){function h(){return false;}function d(i){if(!isBackend){f(i,this.isEmpty(i));}}function g(i){return(NS.jQuery("#"+i+":visible").length>0);}function f(n,m){var l={PANE:"_pane",LNK:"lnk",LAYER:"_layer"};if(!isBackend){var q="";if(document.getElementById(n+l.PANE)!=null){q=l.PANE;}else{if(document.getElementById(n+l.LNK)!=null){q=l.LNK;}else{if(document.getElementById(n+l.LAYER)!=null){q=l.LAYER;}}}var p=ns_tabUtils.isTabAreaVisible(n+q);if(p!==m&&!m){return;}}var r=m?"none":"";var o=["upperlt","uppermiddot","uppermid","upperrt","lt","lnkdot","lnk","rt","_umh"];for(var k=0;k<o.length;++k){var j=document.getElementById(n+o[k]);if(j!=null){j.style.display=r;}}var j=document.getElementById(n+l.PANE);if(j!=null){j.style.display=r;}else{j=document.getElementById(n+l.LAYER);if(j!=null){j.style.display=r;}}}function c(o,j){var p=[];var l=a(o);if(l){var n=l.parentNode.children;for(var k=0;k<n.length;k++){var m=n[k];if(m&&m.id.substring(m.id.length-3)==="lnk"){if(!!j||m!==l){p.push(m);}}}}return p;}function b(k){var l=c(k,false);for(var j=0;j<l.length;j++){if(l[j].style.display.indexOf("none")===-1){return true;}}return false;}function a(i){return document.getElementById(i+"lnk");}return{updateTabVisibility:d,isEmpty:h,isTabAreaVisible:g,hideTab:f,hasTabVisibleSibling:b,getTabSiblings:c,getLayeredTab:a};})();function setRichTextEditorValue(b,d,a){var c=getHtmlEditor(b.name);if(c!=null&&b==c.hddn){if(c.initialized){c.setValue(d,true);}else{c.on("initialize",function(){c.setValue(d,true);});}}else{if(a>0){setTimeout(function(){setRichTextEditorValue(b,d,a-1);},200);}}}function setFormValue(f,i,k,j,a){if(f==null){return;}if(f.type=="checkbox"){setNLCheckboxValue(f,i);}else{if(f.type=="radio"||(f.length>0&&f[0]!=null&&f[0].type=="radio")){syncradio(f,i);}else{if(f.type=="select-one"){synclist(f,i);}else{if(isNLDropDown(f)){getDropdown(f).setValue(i,true);if(k!=null&&k.length>0&&f.form&&f.form.elements){var g=f.form.elements[f.name+"_display"];if(g){g.value=k;g.style.color="#000000";}}}else{if(isMultiSelect(f)){syncmultiselectlist(f,i,null,true);}else{if(isRichTextEditorUnregisteredSafe(f)){if(window.getHtmlEditor!=null){setRichTextEditorValue(f,i,10);}}else{if(f.nodeName=="INPUT"||f.nodeName=="TEXTAREA"||window.virtualBrowser){var c=i!=null&&i.join!=null&&(isPopupMultiSelect(f)||isArray(i))?i.join(String.fromCharCode(5)):i;if(isPopupSelect(f)){syncpopup(f,c,k);}else{if(isPopupMultiSelect(f)){syncmultiselectlist(f,c,k,true);}else{if(isCurrencyField(f)){setNLCurrencyValue(f,i);}else{if(isNumericField(f)){setNLNumericValue(f,i);}else{if(isMultiSelectInput(f)){var d=document.getElementById(f.id+"_multiselect");syncmultiselectlist(d,c,k);d.onchange();}else{f.value=(c==null)?"":c;if(isDisplayOnlySelect(f)&&typeof k!="undefined"){document.getElementById(f.name+"_displayval").innerHTML=k!=null?k.replace(new RegExp(String.fromCharCode(5),"g"),"<BR>"):"";}}}}}}}else{f.innerHTML=i;}}}}}}}var b=f;if((isNumericField(f)||isCurrencyField(f))&&getNLNumericOrCurrencyDisplayField(f)!=null){b=getNLNumericOrCurrencyDisplayField(f);}if(b.machine){b.machine.setFieldInputValue(f.name,i,j,k);}else{if(b.uiform){b.uiform.setFieldInputValue(f.name,i,j,k);}}if(j){var h=getSlavingAsync();try{if(a){setSlavingAsync(false);}fireProperOnChange(f);}finally{setSlavingAsync(h);}}}function getFormValue(a,b){if(a==null){return null;}if(a.type=="checkbox"){return a.checked?"T":"F";}else{if(a.type=="radio"||(a.length>0&&a[0].type=="radio")){return getRadioValue(a);}else{if(a.type=="select-one"||isNLDropDown(a)){return getSelectValue(a);}else{if(isMultiSelect(a)){return getMultiSelectValues(a,b);}else{if(isRichTextEditor(a)){return a.value;}else{return b&&a.value!=null&&isPopupMultiSelect(a)?a.value.split(String.fromCharCode(5)):a.value;}}}}}}function getParameter(d,c){if(typeof c=="undefined"||c==null){c=document;}var a=new RegExp(".*[?&]"+d+"=([^&]*)");var b=a.exec(c.location.href.toString());return b!=null&&b.length>0?decodeURIComponent(b[1]):null;}function getParam(a){var b=getParameter(a);if(b&&b.indexOf("#")>-1){b=b.substring(0,b.lastIndexOf("#"));}return b;}function getBooleanParameter(a){return getParameter(a)=="T";}function getParameterValuesArray(){var c=document.location.href.toString();if(c.indexOf("?")<0){return null;}var f=c.substring(c.indexOf("?")+1).split("&");var b=[];for(var d=0;d<f.length;d++){var g=f[d].split("=");b[b.length]=g[0];b[b.length]=g.length>0?g[1]:null;}return b;}function getFormElement(f,d,b){var a=null;if(f!=null){if(d=="language"||(!isBackend&&(d=="item"||d=="cash"))){for(var c=0;c<f.elements.length;c++){if(f.elements[c].name==d){a=f.elements[c];break;}}}else{if(b&&b=="inlinehtml"){a=document.getElementById(d+"_val");}else{if(f.elements!=null){a=f.elements[d];}}}}return a;}function getFormElementViaFormName(b,a){return getFormElement(document.forms[b],a);}function findGlobalPosX(c,a){var b=0;if(document.getElementById||document.all){while(c.offsetParent){b+=c.offsetLeft;c=c.offsetParent;}if(c.document!=null&&c.document.parentWindow!=null&&c.document.parentWindow.frameElement){b+=findGlobalPosX(c.document.parentWindow.frameElement);}}else{if(document.layers){b+=c.y;}}return b;}function findGlobalPosY(b){var a=0;if(document.getElementById||document.all){while(b.offsetParent){a+=b.offsetTop;b=b.offsetParent;}if(b.document!=null&&b.document.parentWindow!=null&&b.document.parentWindow.frameElement){a+=findGlobalPosY(b.document.parentWindow.frameElement);}}else{if(document.layers){a+=b.y;}}return a;}function findAbsolutePosX(a){var b=0;if(document.getElementById||document.all){while(a.offsetParent){b+=a.offsetLeft;if(a.offsetParent!=document.body){b-=a.offsetParent.scrollLeft;}a=a.offsetParent;}}else{if(document.layers){b+=a.x;}}return b;}function findAbsolutePosY(b){var a=0;if(document.getElementById||document.all){while(b.offsetParent){a+=b.offsetTop;if(b.offsetParent!=document.body){a-=b.offsetParent.scrollTop;}b=b.offsetParent;}}else{if(document.layers){a+=b.y;}}return a;}function findPosX(c){var d=0;var b=(window.parentAccesible&&parent&&parent.NS);var a=(b?(!!parent.NS.Window.getActive()):false);if(a){d=c.offsetParent.offsetLeft;}else{if(document.getElementById||document.all){while(c.offsetParent){d+=c.offsetLeft;c=c.offsetParent;}}else{if(document.layers){d+=c.x;}}}return d;}function findPosY(b){var a=0;if(document.getElementById||document.all){while(b.offsetParent){a+=b.offsetTop;b=b.offsetParent;}}else{if(document.layers){a+=b.y;}}return a;}function getParentElementByTag(a,b){if(!a){return null;}var c=b;while(c!=null){if(c.tagName.toLowerCase()==a.toLowerCase()){return c;}if(c==c.parentNode){break;}c=c.parentNode;}return null;}function contains(a,b){var c=b;while(c!=null){if(c==a){return true;}c=c.parentNode;}return false;}function fireProperOnChange(a,b){if(!isBackend){if(a!=null){if(b==null){b=window;}if(a.getAttribute("onChangeFunc")){b.localEval(a.getAttribute("onChangeFunc").replace(/this/g,"document.forms."+a.form.name+"."+a.name));}else{if((a.type=="checkbox"||a.type=="radio")&&a.onclick){a.onclick();}else{if(a.onchange){a.onchange();}}}}}}function getInlineTextValue(b){if((typeof b=="undefined")||b==null){return"";}if(isBackend){return b.value;}else{var a="";if(b.innerText){a=b.innerText;}else{a=b.innerHTML.replace(/<br>/gi,"\n").replace(/(<([^>]+)>)/gi,"");}return a;}}function setInlineTextValue(a,b){if(a==null){return;}a.innerHTML=b;if(isBackend){a.value=b;}}function setTextValue(a,b){if(a){a.textContent=b;if(isBackend){a.value=b;}}}function findUp(b,a){while((b!=null)&&(b.nodeName!=a)){b=b.parentNode;}return b;}function getEvent(a){return(typeof(a)!="undefined"&&a)?a:((typeof(event)!="undefined"&&event)?event:null);}function getTarget(b){var a=getEvent(b);return a.target||a.srcElement;}function attachEventHandler(g,d,f,a){var b=getEvent(g);var c=function(i){var h=getEvent(i);f.call(d,h);};f.handlerBound=c;if(d.addEventListener){d.addEventListener(b,c,!!a);}else{if(d.attachEvent){d.attachEvent("on"+b,c);}else{d["on"+b]=c;}}}function detachEventHandler(f,c,d,a){var b=getEvent(f);if(c.removeEventListener){c.removeEventListener(b,d.handlerBound,!!a);}else{if(c.detachEvent){c.detachEvent("on"+b,d.handlerBound);}else{c["on"+b]=null;}}}function preventDefault(b){var a=getEvent(b);if(a.preventDefault){a.preventDefault();}else{a.returnValue=false;}}function stopPropagation(b){var a=getEvent(b);if(a.stopPropagation){a.stopPropagation();}else{a.cancelBubble=true;}}function getEventAltKey(a){a=getEvent(a);if(a&&typeof a.altKey!="undefined"){return a.altKey;}else{if(typeof event!="undefined"&&typeof event.altKey!="undefined"){return event.altKey;}}return false;}function getEventCtrlKey(a){a=getEvent(a);return(a)?a.ctrlKey:false;}function getEventShiftKey(a){a=getEvent(a);return(a)?a.shiftKey:false;}function getEventTarget(a){a=getEvent(a);if(a){if(a.srcElement){return a.srcElement;}if(a.target){return a.target;}}return null;}function getEventTargetType(a){a=getEventTarget(a);return(a)?a.type:null;}function setEventPreventDefault(a){a=getEvent(a);if(a){if(a.preventDefault){a.preventDefault();}else{a.returnValue=false;}}}function setEventCancelBubble(a){a=getEvent(a);if(a){if(a.stopPropagation){a.stopPropagation();}else{a.cancelBubble=true;}}}function restoreHtmlEditors(b){if(typeof NetSuite=="object"&&typeof NetSuite.RTEManager=="object"){var a=document.forms.main_form!=null&&document.forms.main_form.elements.nlapiVF!=null?document.forms.main_form.elements.nlapiVF.value:null;try{if(a!=null){document.forms.main_form.elements.nlapiVF.value="";}NetSuite.RTEManager.forEach(function(c){if((b==null||c.hddn.form==b)&&c.getValue()!=c.hddn.value){c.setValue(c.hddn.value);}});}finally{if(a!=null){document.forms.main_form.elements.nlapiVF.value=a;}}}}function getFlhUrl(j,g,h,o,f,a,m,n,l,d,p,i,b){var c={};var k=NS.Help.flhUrlParams;c[k.PARENT_ID.name]=g;c[k.LIST_ID.name]=h;c[k.FLH_TYPE.name]=f;c[k.TOPIC_ALIAS_KEY.name]=a;c[k.COMPANY.name]=m;c[k.PARENT_TYPE.name]=n;c[k.VARIANT_ID.name]=o;c[k.TRANSACTION_FORM.name]=l;c[k.FORM_TITLE_TRAN_KEY.name]=d;c[k.FORM_TITLE.name]=p;c[k.FIELD_LABEL_TRAN_KEY.name]=i;c[k.FIELD_LABEL.name]=b;var q={fieldId:j,parameters:c};return NS.Help.getFieldHelpUrl(q);}function nlFieldHelp(k,s,c,u,a,l,j,f,d,v,w,m,t,n,b){var i=getFlhUrl(s,u,a,l,j,f,d,v,w,m,t,n,b);if(NS&&NS.Dashboard){nlExtOpenWindow(i,"fieldhelp",400,205,c,false,k,{},c);return false;}var o="fieldhelp";var r=400;var q=150;if(c!=null){var g=Math.min(screen.availWidth-r,getObjectLeft(c));var p=Math.min((screen.availHeight-40)-q,getObjectTop(c)+c.offsetHeight);}var h=window[o];if(typeof h=="undefined"||h==null||h.closed){h=window.open(i,o,"scrollbars="+(isIE?"no":"yes")+",width="+Math.min(screen.availWidth,r)+",height=100,left="+g+",top="+p+",resizable=yes");}else{h.location=i;h.moveTo(g,p);}h.focus();window[o]=h;return false;}function NLAlert(b,a){alert(b);}function findClassUp(b,a){while((b!=null)&&(b.className!=a&&b.classAlias!=a)){b=b.parentNode;}return b;}function getScrollLeftOffset(a){var b=0;var c;if(a!=null&&(c=findClassUp(a,"scrollarea"))!=null){b=c.scrollLeft;}else{if((c=document.getElementById("div__body"))!=null){b=c.scrollLeft;}}return b;}function getScrollTopOffset(a){var b=0;var c;if(a!=null&&(c=findClassUp(a,"scrollarea"))!=null){b=c.scrollTop;}else{if((c=document.getElementById("div__body"))!=null){b=c.scrollTop;}}return b;}function removeAllChildren(a){while(a.childNodes[0]){a.removeChild(a.childNodes[0]);}}function StringBuffer(){this.buffer=[];}StringBuffer.prototype.append=function(a){this.buffer.push(a);return this;};StringBuffer.prototype.toString=function(){return this.buffer.join("");};function setObjectOpacity(a,c){var b=c.style;b.opacity=(a/100);b.MozOpacity=(a/100);b.filter="alpha(opacity="+a+")";}function fadeObjectOpacity(g,d,b,a){var f=Math.round(a/100);var h=0,c;if(d>b){for(c=d;c>=b;c--){setTimeout(function(){setObjectOpacity(c,g);},(h*f));h++;}}else{if(d<b){for(c=d;c<=b;c++){setTimeout(function(){setObjectOpacity(c,g);},(h*f));h++;}}}}function tellafriend(f,c,d,i,g,a,h){var b=encodeURIComponent(c)+",%0d%0a%0d%0a";b+=encodeURIComponent(d)+encodeURIComponent(location.hostname)+".%0d%0a%0d%0a";b+=encodeURIComponent(i)+encodeURIComponent(document.title)+".%0d%0a";b+=encodeURIComponent(g)+encodeURIComponent(h)+"%0d%0a";b+=encodeURIComponent(a)+encodeURIComponent(location.href)+"%0d%0a";location.href="mailto:?subject="+encodeURIComponent(f)+"&body="+b;}function isLeftButtonDown(c){var a=false;var b=getEvent(c);if(isIE&&b.button==1||(!isIE&&b.button==0)){a=true;}return a;}function isRightButtonDown(c){var a=false;var b=getEvent(c);if(b.button==2){a=true;}return a;}function getSelectedTextRange(d){var c,b,a;if(document.all){var f=document.selection.createRange();a=f.duplicate();a.moveToElementText(d);a.setEndPoint("EndToEnd",f);c=a.text.length-f.text.length;b=c+f.text.length;}else{c=d.selectionStart;b=d.selectionEnd;}a=[];a[0]=c;a[1]=b;return a;}function insertTextAtCursor(c,f){c.focus();if(document.all){var d=document.selection.createRange();d.text=f;d.scrollIntoView(true);}else{var b=c.selectionStart;var a=c.selectionEnd;c.value=c.value.substring(0,b)+f+c.value.substring(a);c.selectionEnd=c.selectionStart+f.length;c.selectionStart=c.selectionEnd;}}function setWindowChanged(b,a){b.NS.form.setChanged(a);}function escapeHTML(b){var c=document.createElement("div");var a=document.createTextNode(b);c.appendChild(a);return c.innerHTML;}function escapeHTMLAttr(a){a=escapeHTML(a);return a.replace(/"/g,"&quot;").replace(/'/g,"&#39;");}function getRuntimeSize(b,a){var c=getRuntimeStyle(b,a);if(!c){return 0;}c=c.replace("px","");if(isNaN(c)){return 0;}return c*1;}function getRuntimeStyle(b,a){var c=null;if(typeof b=="string"){b=document.getElementById(b);}if(b==null){return c;}if(window.getComputedStyle){c=document.defaultView.getComputedStyle(b,null)[a];}else{if(b.currentStyle){c=b.currentStyle[a];}}if(c=="auto"){if(a=="height"){c=b.offsetHeight;}else{if(a=="width"){c=b.offsetWidth;}}}return c;}function camelize(f){var d=f.split("-");var a=d.length;if(a==1){return d[0];}var c=f.charAt(0)=="-"?d[0].charAt(0).toUpperCase()+d[0].substring(1):d[0];for(var b=1;b<a;b++){c+=d[b].charAt(0).toUpperCase()+d[b].substring(1);}return c;}function eval_js(sScript){sScript=sScript.replace(/^\s*<!--[\s\S]*?-->\s*$/gm,"");try{return eval(sScript);}catch(e){if(isDebug||NS.Logger.debugValue){if(window.console!=undefined){window.console.log(e);}}}}var slave_machines={};function extractMachineHtmlFromText(d){for(var c=0;c<d.length;c++){var a=d[c].indexOf("name='")+6;var b=d[c].substring(a,d[c].indexOf("'>",a));slave_machines[b]=d[c].substring(d[c].indexOf("'>")+2,d[c].lastIndexOf("</machine>"));}}function isFunction(a){return Object.prototype.toString.call(a)==="[object Function]";}function process_slaving_result(response){var sText=response.getBody();var components=sText.split("<machine");extractMachineHtmlFromText(components);var script=components[0];if(response.getHeaders()["newslaving"]!=null){eval(script);if(slaveValues.machinesData){slavingUtil.redrawEditMachines(slaveValues.machinesData);}slavingUtil.processSlavingValues(slaveValues.fields);if(slaveValues.aspectScript!=null){if(isFunction(slaveValues.aspectScript)){slaveValues.aspectScript.call();}}NS.form.setInited(true);window.status="";}else{eval_js(script);}slave_machines={};}var process_slaving_result_original=process_slaving_result;function loadSlavingResults(a,d,c){if(!isBackend){var b=process_slaving_result;if(!!d){if(typeof d==="function"){b=function(){process_slaving_result.apply(this,arguments);d.apply(this,arguments);};}else{if(Object.prototype.toString.call(d)==="[object Array]"){b=function(f){var g=0;process_slaving_result.apply(this,arguments);while(g<d.length){d[g++].apply(this,arguments);}};}}}if(typeof c==="undefined"||c===null){c=getSlavingAsync();}nlXMLRequestURL(a,null,null,b,c);}}function adjustMachineData(a,c){if(!c||!a){return c;}var d=a.split("\x01");if(d.length<=c.split("\x02",1)[0].split("\x01").length){return c;}var b=c.split("\x02");b=b.map(function(f){var j=0;var g=f.split("\x01");var h=d.map(function(i){return i.substring(0,8)==="custpage"?"":g[j++];});return j===g.length?h.join("\x01"):f;});return b.join("\x02");}function execute_js(a,b){eval_js(a.getBody());if(b){b();}}function NLGetCurrentScriptFileHostName(){var a=document.getElementsByTagName("script");if(!a||a.length==0){return null;}var b=a[a.length-1].src;if(!b){return null;}var c=b.match(/^((http|https):\/\/)?[^\/]+/g);if(c&&c.length>0){c=c[0];}if(!c){c="";}return c;}function NLLoadScriptInScriptTag(c,f,d){if(!d){d=document;}var a=d.getElementById(f);if(!a){var b=d.getElementsByTagName("head")[0];a=d.createElement("script");a.type="text/javascript";b.appendChild(a);}a.src=c;}function loadXMLJSDoc(a,b){nlXMLRequestURL(a,null,null,function(c){execute_js(c,b);},true);}function nlXMLRequestURL(b,c,g,a,d){var f=new NLXMLHttpRequest();if(a instanceof Function){f.setResponseHandler(a);}return f.requestURL(b,c,g,d);}function NLXMLHttpRequest(a){this.requestPending=false;this.callbackFunc=null;this.ignoreResponseErrors=a;if(window.XMLHttpRequest){this.xmlrequest=new XMLHttpRequest();}else{try{this.xmlrequest=new ActiveXObject("Msxml2.XMLHTTP.4.0");}catch(b){this.xmlrequest=new ActiveXObject("Msxml2.XMLHTTP");}}}NLXMLHttpRequest.prototype.pendingSyncRequests=[];NLXMLHttpRequest.prototype.pendingAsyncResponseCallbacks=[];NLXMLHttpRequest.prototype.setResponseHandler=function(a){this.callbackFunc=typeof a=="function"?a:null;};NLXMLHttpRequest.prototype.requestURL=function(b,j,i,d,c){if(this.requestPending){return;}this.requestPending=true;var a;if(!isValEmpty(c)){a=c;}else{a=j!=null?"POST":"GET";}if(typeof nsDefaultContextObj!=="undefined"&&nsDefaultContextObj!==null){b+=b.indexOf("?")>0?"&":"?";b+="c="+nsDefaultContextObj.company;b+="&isExternal=T";}this.xmlrequest.open(a,b,(d!=null?d:false));for(var g in i){this.xmlrequest.setRequestHeader(g,i[g]);}this.xmlrequest.setRequestHeader("NSXMLHttpRequest","NSXMLHttpRequest");if(a=="POST"||a=="PUT"){if(j instanceof String||typeof j=="string"||nsInstanceofDocument(j)){this.xmlrequest.setRequestHeader("Content-Type","text/xml; charset=UTF-8");}else{j=formEncodeURLParams(j);this.xmlrequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");}}var f=null;if(d){this.xmlrequest.onreadystatechange=this.handleResponse.bindAsEventListener(this);this.xmlrequest.send(j);}else{this.pendingSyncRequests.push(this);try{this.xmlrequest.send(j);}finally{var h=(function(m){var k=undefined;var l=m.pendingSyncRequests.length;while(l>0){l-=1;if(m===m.pendingSyncRequests[l]){k=l;break;}}return k;})(this);if(h!==undefined){this.pendingSyncRequests.splice(h,1);}while(this.pendingAsyncResponseCallbacks.length>0){this.pendingAsyncResponseCallbacks.shift()();}}f=this.handleResponse();}return f;};NLXMLHttpRequest.prototype.handleResponse=function(){var f=null;if(this.xmlrequest.readyState==4){var o=this.xmlrequest.status;var c=this.xmlrequest.responseText;var a=[];var g=this.xmlrequest.getAllResponseHeaders();var d=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/gm,"");};var k=function(i){if(!i){return false;}i=d.call(i);return i&&i.indexOf("{")===0&&i.lastIndexOf("}")===i.length-1;};g=g.replace(/^\s+/,"").replace(/\s+$/,"").split("\n");for(var h=0;h<g.length;h++){var l=g[h].split(":");var j=l[0];var m=a[j];if(m==null){m=[];a[j]=m;}m[m.length]=l[1];}var n=null,b;if(c&&c.toLowerCase().indexOf("error")>=0){if(k(c)){if(c.indexOf('{"error"')>=0){var b=JSON.parse(c);n=new NLXMLResponseError(b.error.code,b.error.message);}}else{if(c.indexOf("<onlineError>")>=0){b=nsStringToXML(c);n=new NLXMLResponseError(nsSelectValue(b,"/onlineError/code"),nsSelectValue(b,"/onlineError/detail"),nsSelectValue(b,"/onlineError/id"));}else{if(c.indexOf("<error>")>=0){b=nsStringToXML(c);n=new NLXMLResponseError(nsSelectValue(b,"/error/code"),nsSelectValue(b,"/error/message"));}else{if(k(c)&&c.indexOf('{"error"')>=0){b=JSON.parse(c);n=new NLXMLResponseError(b.error.code,b.error.message);}else{if(c.indexOf("error code:")>=0&&c.indexOf("error message:")>=0&&o!=200){b=c.split("\n");n=new NLXMLResponseError(b[0].substring("error code: ".length),b[1].substring("error message: ".length));}}}}}}else{if(o!=200&&o!=206&&o!=500){n=new NLXMLResponseError("SERVER_RESPONSE_ERROR",c);}}try{if(n!=null&&this.callbackFunc==null&&!this.ignoreResponseErrors){throw n;}f=new NLXMLResponse(o,c,a,n);if(this.callbackFunc!=null){if(this.pendingSyncRequests.length>0){this.pendingAsyncResponseCallbacks.push(function(p,i){setTimeout(function(){p.callbackFunc(i);},0);}.bind(null,this,f));}else{this.callbackFunc(f);}}}finally{this.requestPending=false;}}return f;};function NLXMLResponse(c,d,b,a){this.code=c;this.body=d;this.headers=b;this.error=a;this.getCode=function(){return this.code;};this.getBody=function(){return this.body;};this.getError=function(){return this.error;};this.getHeaders=function(){return this.headers;};}function NLXMLResponseError(c,a,b){this.id=b;this.code=c;this.details=a;this.getId=function(){return this.id;};this.getCode=function(){return this.code;};this.getDetails=function(){return this.details;};}function nsServerCall(g,f,d,a,c){var b=new NLJsonRpcClient(g);return b.sendRequest(f,d,a,c);}NLJsonRpcClient=function(a){if(a.indexOf("?")>0){a=a+"&jrr=T";}else{a=a+"?jrr=T";}this.serverURL=a;this.responseCallbackMap={};};NLJsonRpcClient.requestId=0;NLJsonRpcClient.prototype={sendRequest:function(j,h,k,b){b=b||"GET";var g={id:NLJsonRpcClient.requestId++,method:"remoteObject."+j,params:h||[]};if(k!=null){this.responseCallbackMap[g.id]=k;}var f=new NLXMLHttpRequest();if(k!=null){f.setResponseHandler(this.handleResponseAsync.bindAsEventListener(this));}var a=this.serverURL;var c=null;if("GET"==b){a+="&jrid="+g.id;a+="&jrmethod="+g.method;if(g.params.length>0){a+="&jrparams="+encodeURIComponent(toJSON(g.params));}if(a.length>2083){b="POST";a=this.serverURL+"&jrq=T";}}if("POST"==b){c=toJSON(g);}var d=f.requestURL(a,c,null,k!=null?true:false);if(k==null){var i=this.getJsonRpcResponse(d);if(i.error){throw new NLXMLResponseError(i.error.code,i.error.trace,i.error.msg);}d=i.result;}return d;},getJsonRpcResponse:function(nlXMLResponseObj){var jsonRpcResp=nlXMLResponseObj.getBody();if(jsonRpcResp!=null){jsonRpcResp=jsonRpcResp.replace(/^\s*<!--[\s\S]*?-->\s*$/gm,"");}eval("jsonRpcResp = "+jsonRpcResp+";");return jsonRpcResp;},handleResponseAsync:function(a){var b=this.getJsonRpcResponse(a);var c=this.responseCallbackMap[b.id];this.responseCallbackMap[b.id]=null;c(b.result,b.error);}};if(typeof Function.prototype.bind!=="function"){Function.prototype.bind=function(b){var a=this;return function(){a.apply(b,arguments);};};}Function.prototype.bindAsEventListener=function(b){var a=this;return function(c){a.call(b,c||window.event);};};function clone(c){if(typeof(c)!="object"){return c;}if(c==null){return c;}var a={};for(var b in c){a[b]=clone(c[b]);}return a;}function leftPadWithWrapping(a,d,c){if(d==null){d="";}if(a==null){a="";}else{a=trim(a);}if(c<=d.length){return d.substring(0,c);}var f=d.length+a.length;if(f<=c){return d+a;}else{var b=a.length-(f-c);return(d+a.substring(0,b))+"\n"+leftPadWithWrapping(a.substring(b),d,c);}}function nlFireEvent(c,d){if(document.createEvent){var b="HTMLEvents";if(d=="click"||d.indexOf("mouse")==0){b="MouseEvents";}var a=document.createEvent(b);a.initEvent(d,true,true);return !c.dispatchEvent(a);}else{var a=document.createEventObject();return c.fireEvent("on"+d,a);}}function getOuterHTML(a){var b;if(!a){return null;}if(a.outerHTML){return a.outerHTML;}b=document.createElement("div");b.appendChild(a.cloneNode(true));return b.innerHTML;}function NLNumberToString(d,h){if(typeof h=="undefined"){h=window;}var i=d+"";if(h.groupseparator==""){return i;}var k=i.lastIndexOf(",");var a=i.lastIndexOf(".");var g=".";if(k>a){g=",";}var f=i.split(g);var b=f[0];var c=f.length>1?h.decimalseparator+f[1]:"";var j=/(\d+)(\d{3})/;while(j.test(b)){b=b.replace(j,"$1"+h.groupseparator+"$2");}if(d<0&&h.negativeprefix!="-"){return h.negativeprefix+b.replace("-","")+c+h.negativesuffix;}else{return b+c;}}function NLStringToNumber(f,d){if(isValEmpty(f)){return"";}if(f.indexOf("%")>=0){return NLStringToNumber(f.replace("%",""),d)+"%";}if(window.groupseparator&&window.groupseparator!=""){f=f.replace(new RegExp("\\"+window.groupseparator,"g"),"");}if(window.negativeprefix!="-"&&f.indexOf(window.negativeprefix)==0){f="-"+f.replace(window.negativeprefix,"").replace(window.negativesuffix,"");}if(window.decimalseparator==","){f=f.replace(",",".");}var c=parseFloat(f);if(isNaN(c)){return NaN;}if(d&&c.toString().search(/e/i)<0){var b=0;var a=f.indexOf(".");if(a!=-1){b=f.length-a-1;}c=c.toFixed(b);}return c;}function NLStringToNormalizedNumberString(b){var a=b.indexOf(window.decimalseparator);return NLStringToNumber(b,a!=-1)+"";}function NLHideDiv(b){var a=document.getElementById(b);a.style.display="none";}function NLCreateCookie(c,d,f){var a="";if(f){var b=new Date();b.setTime(b.getTime()+(f*24*60*60*1000));a="; expires="+b.toGMTString();}document.cookie=c+"="+d+a+"; path=/";}function escapeJSChars(d){var b="";for(var a=0;a<d.length;a++){var f=d.substr(a,1);if(f=="'"||f=='"'||f=="\\"){b+="\\";}b+=f;}return b;}function expandOrCollapseRows(j,d,h){var b="/images/forms/plus.svg";var c="/images/forms/minus.svg";var a=document.getElementById(j+"row"+d+"collapse");if(!a){return;}if(typeof h=="undefined"){h=(a.src.indexOf(c)!=-1);}for(var g=d+1;!document.getElementById(j+"row"+g+"collapse");g++){var f=document.getElementById(j+"row"+g);if(!f){break;}f.style.display=h?"none":"";}a.src=h?b:c;}function expandOrCollapseAllRows(c,b){for(var a=0;document.getElementById(c+"row"+a);a++){expandOrCollapseRows(c,a,b);}}function setLabel(c,b){if(!isBackend){var g=document.getElementById(c+"_lbl");if(g==null){return;}var a=g;var f=a.getElementsByTagName("A");if(f.length>0){a=f[0];}a.innerHTML=b;var d=document.getElementById(c+"_lbl_uir_label");if(d){NS.jQuery(d).toggleClass("uir-label-empty",b.length===0);}}}function globalFunctionOrDummy(a,b){return(a in window)?window[a]:function(){return b;};}if(!isBackend){var alert_inner=alert;window.alert=function(b){try{alert_inner(b);}catch(a){}};var confirm_inner=confirm;window.confirm=function(b){try{return confirm_inner(b);}catch(a){return true;}};}